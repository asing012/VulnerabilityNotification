#!/usr/bin/env python3
# Fetch latest updated CVEs


import requests
import os
from sendgrid import SendGridAPIClient
from sendgrid.helpers.mail import Mail


URL = "http://cve.circl.lu/api/last"

req = requests.get(url = URL)

data = req.json()

# sending email
message = Mail(
    from_email='akshayc_118@hotmail.com',
    to_emails='jaistudy1996@gmail.com',
    subject='Latest updated CVEs',
    html_content='<br>'+str(data))
try:
    sg = SendGridAPIClient(os.environ.get('SENDGRID_API_KEY'))
    response = sg.send(message)
    print(response.status_code)
except Exception as e:
    print(e.message)


#print(data)
